\section{Introduction}

The Internet of Things (IoT) paradigm promises to interconnect the world and
change the way data is collected and processed.
This revolution is largely built on the establishment of large networks of small 
devices that autonomously exchange data.
Typically, these devices have low computational capabilities and process
sensible data.
As a consequence, these networks attract the attention of malicious entities
that attempt to exploit the poor security standards usually employed in such
environments.

Remote Attestation (RA) has been suggested as a potential solution to mitigate the
security concerns.
It allows a remote entity (\ie Verifier) to validate the integrity of
the software of a local device (\ie Prover).
This process usually makes use of a signed hash value of the Proverâ€™s software, 
generated by dedicated hardware.
To deal with scalability issues, Collective Remote Attestation (CRA) has 
been proposed as an adaptation of classical RA to check the status of a network 
in a decentralized fashion.

SANA(~\cite{sana}) is a CRA scheme that promises to inspect the overall
status of an IoT network with a single and efficient operation.
The attestation request is propagated by the owner to the best neighbor (\ie the node with the best connection) which proceeds to propagate the request to its neighbors.
This operation is repeated until all the interested provers are reached.
The provers, which are the leaves of the tree, respond by signing a message and then sending it back through the tree.
It does so by introducing a signature scheme called Optimistic Aggregated
Signature (OAS) allows the aggregation of the signatures coming from
different devices.
The aggregated signature is smaller than the naive one (\ie list of appended
signatures) and makes the verification cost depends only on the number of
compromised devices.
SANA comes with estimations about its memory, communication, and computational costs. But the formulas neglect to specify some variables that prove to be decisive to determine these estimations.
We chose to implement the protocol using an ECC algorithm based on Ethereum to handle the signing and verification phases of the protocol, then we analyzed the results to prove the claims that were given in the SANA paper and at last make some considerations about the criticalities of this protocol.

In this article we verify the security claims made in SANA's paper.
In particular, we focus on checking the overall cost for running the protocol
and the soundness of its propagation process.
We prove that the complexity of the verification is linear with the number of compromised devices.
On the other hand, we also discuss possible problems regarding the aggregation cost and memory cost for the Aggregators.
We discuss the criticalities in scenarios where one or more devices (\eg Aggregators, Provers) are manumitted or malfunctioning.
At last, we present some considerations on the feasibility of SANA in a scope where the devices are small, moving, and often unreliable.